<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">

<head>
    <meta charset="utf-8" />
    <title>Tesla Entertainment</title>
    <link rel="stylesheet" href="Tesla_Design_Anna.css">

</head>

<body>

    <header>
        <button id="Back" class="Status">
            <img src="Home.png" width="53" height="50">
        </button>
        <div id="Date" class="Status">

        </div>
        <div id="Logo" class="Status">
            <img src="Logo.png" width="53" height="50"> <!-- Proportion 1,0575-->
        </div>
        <div id="Time" class="Status">

        </div>
        <div id="Temp" class="Status">

        </div>

    </header>

    <main>
        <button id="button0" class="Value">
            <img src="Schloss zu.png" width="53" height="50" id="locked">
            <img src="Schloss auf.png" width="53" height="50" id="unlocked">
        </button>
        <button id="button1" class="Value">
            Luftdruck:
        </button>
        <button id="button2" class="Value">
            Luftfeuchtigkeit:
        </button>
        <button id="button3" class="Value">
            Verbrauch:
        </button>
        <button id="button4" class="Value">
            Geschwindigkeit:
        </button>

    </main>

    <footer>
        <div id="Title" class="Music">
            ♪♫ MUSIK ♪♫
        </div>
        <div class="Music" id="musicPlayer">
            <audio id="audioControls"
                   controls
                   src="Wohin Du Gehst.mp3"
                   type="audio/mp3"></audio>
        </div>
        <div class="Music" id="musicCover">
            COVER
        </div>
    </footer>

    <script>

        //Get Python Service Data
        document.getElementById("locked").style.display = "block";
        document.getElementById("unlocked").style.display = "none";
        fetch('http://192.168.0.164:5000/status').then(function (response) {
            response.text().then(function (text) {
                // var e = document.getElementById("data").innerHTML = text;
                let actualValues = text.split(/,|:/);
                console.log(text);

                //function Music() {
                //    fetch('http://192.168.0.164:5000/music').then(function (response) {
                //        response.text().then(function (text) {

                //            console.log("Test Music");

                //        });
                //    });

                //}
                //document.getElementById("Title").addEventListener("click", Music);


                //Template HomeScreen
                function ShowTemplate() {
                    document.querySelector("main").innerHTML = "";
                    // document.getElementById("Back").disabled = true; //Zurück kann nur einmal betätigt werden
                    document.getElementsByTagName("main")[0].appendChild(
                        document.getElementsByClassName("Home")[0].content.cloneNode(true));
                    document.getElementById("button1").innerHTML += actualValues[5].substr(1, 6) + " kPa";

                    //Consumption
                    document.getElementById("button3").innerHTML += actualValues[1].substr(1, 6) + " Liter";

                    //Current Speed
                    document.getElementById("button4").innerHTML += actualValues[7].substr(1, 6) + " km/h";

                    document.getElementById("button1").addEventListener("click", ShowPressure);

                    if (document.getElementById("button0").style.display = "block") {
                        document.getElementById("button0").addEventListener("click", OpenLock);
                    }
                    else if (document.getElementById("button0.5").style.display = "block") {
                        document.getElementById("button0.5").addEventListener("click", CloseLock);
                    }

                }
                document.getElementById("Back").addEventListener("click", ShowTemplate);


                //Template Pressure
                function ShowPressure() {
                    document.querySelector("main").innerHTML = "";
                    document.getElementsByTagName("main")[0].appendChild(
                        document.getElementsByClassName("Pr")[0].content.cloneNode(true));
                    document.getElementById("frontLeft").innerHTML = Math.round(actualValues[5].substr(1, 4) * 0.99) + " kPa";
                    document.getElementById("frontRight").innerHTML = Math.round(actualValues[5].substr(1, 3) * 0.99) + " kPa";
                    document.getElementById("backLeft").innerHTML = actualValues[5].substr(1, 6) + " kPa";
                    document.getElementById("backRight").innerHTML = actualValues[5].substr(1, 6) + " kPa";
                }
                document.getElementById("button1").addEventListener("click", ShowPressure);


                //Current Temperature
                document.getElementById("Temp").innerHTML = actualValues[9].substr(1, 4) + "°C / " + actualValues[3].substr(1, 5) + "%";

                //Current Pressure
                document.getElementById("button1").innerHTML += actualValues[5].substr(1, 6) + " kPa";

                //Current Humidity
                document.getElementById("button2").innerHTML += actualValues[3].substr(1, 6) + " %";

                //Consumption
                document.getElementById("button3").innerHTML += actualValues[1].substr(1, 6) + " Liter";

                //Current Speed
                document.getElementById("button4").innerHTML += actualValues[7].substr(1, 6) + " km/h";


                //Fuction Lock
                //function OpenLock() {

                //    document.getElementById("button0.5").style.display = "block";
                //    document.getElementById("button0").style.display = "none";
                //}
                //document.getElementById("button0").addEventListener("click", OpenLock);


                //function CloseLock() {
                //    document.getElementById("button0.5").style.display = "none";
                //    document.getElementById("button0").style.display = "block";

                //}
                //document.getElementById("button0.5").addEventListener("click", CloseLock);

                //var hidden = false;

                //function hideOrShow()
                //{
                //  if(!hidden)
                //  {
                //    document.getElementById("myimg").style.display = "none";
                //  }
                //  else
                //  {
                //    document.getElementById("myimg").style.display = "block";
                //  }
                //  hidden = !hidden;
                //}
                //Open and close the lock
                function Lock() {
                    if (fetch('http://192.168.0.164:5000/action/unlock').then(function (response) {
                        response.text().then(function (text) {

                        });
                    })) {
                        document.getElementById("locked").style.display = "none";
                        document.getElementById("unlocked").style.display = "block"; document.getElementById("locked").style.display = "block"

                    }
                    else { };

                    if (document.getElementById("unlocked").style.display = "block") {
                        fetch('http://192.168.0.164:5000/action/lock').then(function (response) {
                            response.text().then(function (text) {
                                document.getElementById("unlocked").style.display = "none";
                                document.getElementById("locked").style.display = "block";
                            });
                        });
                    }
                    else { };
                }
                document.getElementById("button0").addEventListener("click", Lock);





            });
        });




        //Current Time
        function currentTime() {
            var Today = new Date();
            var hoursGet = Today.getHours(); var minutesGet = Today.getMinutes(); var secondsGet = Today.getSeconds();
            var Hours, Minutes, Seconds
            Hours = hoursGet + ":";

            if (minutesGet < 10) { Minutes = '0' + minutesGet + ":"; }
            else { Minutes = minutesGet + ":"; }
            if (secondsGet < 10) { Seconds = '0' + secondsGet; }
            else { Seconds = secondsGet; }

            Time.innerHTML = Hours + Minutes + Seconds + " Uhr";

            window.setTimeout("currentTime();", 1000);

        }
        window.onload = currentTime;

        //Current Date
        function getToday() {
            var Today = new Date();

            var Day = Today.getDate(); // Day

            // Months start at 0!
            var Month = Today.getMonth() + 1; // Month

            var Year = Today.getFullYear(); // Year
            if (Day < 10) {
                Day = '0' + day;
            }
            if (Month < 10) {
                Month = '0' + month;
            }
            Today = Day + '.' + Month + '.' + Year;

            return Today;
        }
        document.getElementById("Date").textContent = getToday();
    </script>

    <template class="Home">
        <main>
            <button id="button0" class="Value">
                <img src="Schloss zu.png" width="53" height="50">
            </button>
            <button id="button1" class="Value">
                Luftdruck:
            </button>
            <button id="button2" class="Value">
                Luftfeuchtigkeit:
            </button>
            <button id="button3" class="Value">
                Verbrauch:
            </button>
            <button id="button4" class="Value">
                Geschwindigkeit:
            </button>

        </main>

    </template>

    <template class="Pr">
        <div id="templatePressure">
            <div id="frontLeft" class="carPressure"> vorne links</div>
            <div><img src="Luftdruck.png" id="Car"></div>
            <div id="frontRight" class="carPressure"> vorne rechts</div>
            <div id="backLeft" class="carPressure"> hinten Links</div>
            <div id="backRight" class="carPressure"> hinten rechts</div>
        </div>
    </template>

</body>
</html>